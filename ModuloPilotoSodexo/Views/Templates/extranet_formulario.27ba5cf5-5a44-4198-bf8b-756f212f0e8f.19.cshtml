@model ScriptorContent
@using Viatecla.Factory.Scriptor

@{
	Layout="Extranet_PaginaMaestraUsuarioLogeado";
  	int ic=0;
    string seccionName="";
  	string controllerForm="";
  	if(!String.IsNullOrEmpty(Model.Parts.ControladorAngular))
  	{
    	controllerForm="ng-controller="+Model.Parts.ControladorAngular+"";
  	}
    string estiloAnchoMaximo=(String.IsNullOrEmpty(Model.Parts.AnchoMaximo)==false?";max-width:"+Model.Parts.AnchoMaximo:"");
    string estiloAltoMinimo=(String.IsNullOrEmpty(Model.Parts.AltoMinimo)==false?";min-height:"+Model.Parts.AltoMinimo:"");
      
      string urlcanalmaestro="";
      string idcanalmaestro="";
      string controladoraGenerica="";
      string loadCanal="";
      if(Model.Parts.CanalMaestro.Count>0)
      {
     	urlcanalmaestro=Url.ScriptorChannel(Model.Parts.CanalMaestro[0] as ScriptorChannel).ToString();
        idcanalmaestro=Model.Parts.CanalMaestro[0].Id.ToString();
        controladoraGenerica="ng-controller=ConsultaGenericaController";
        loadCanal="IdCanal='"+Model.Id+"'";
      }
}
<div ng-load="$root.TituloPagina='@(Model.Parts.es_pe__Titulo)'">
</div>
        
<div ng-controller="FormularioBaseController">
<div @(controladoraGenerica) class="block" style="@(estiloAnchoMaximo) @(estiloAltoMinimo)" canalMaestro="@urlcanalmaestro" ng-load="@loadCanal">
      <div  ng-load="IdCanal='@idcanalmaestro'">
         <div @(controllerForm)>
            @foreach(ScriptorContent content in Model.Parts.Secciones)
            {
                ic=ic+1;
                seccionName="seccion-"+ic.ToString();
                try
                {
                  <div id="@(seccionName)">
                  @Html.Template((ScriptorContent)content)
                  </div> 
                }
                catch(Exception ex){
                    @Html.Raw(ex.Message+"<br/><br/>");
                }
            }
         </div> 
	</div>
</div>
</div>

